# 프로세스 
- 운영체제로부터 자원을 할당받은 작업의 단위
- 프로그램을 실행시켜 정적인 프로그램이 동적으로 변하여 프로그램이 돌아가고있는 상태. 즉, 컴퓨터에서 작업 중인 프로그램을 의미.
- 모든 프로그램은 운영체제가 실행되기위낳ㄴ 메모리 공간을 할당 해줘야 실행될수있다. 그래서 프로그램을 실행하는 순간 파일은 컴퓨터 메모리에 올라가게되고 운영체제로부터 시스템 자원(CPU)을 할당받아 프로그램 코드를 실행시켜 우리가 서비스를 이용할 수 있게 되는 것.
- 실행되어 작업중인 컴퓨터 프로그램
- **메모리에 적재되고 CPU자원을 할당받아 프로그램이 실행되고있는 상태**

## 프로세스의 한께
- 과거에는 프로그램을 실행할떄 프로세스 하나만을 사용해서 이용했다. 하지만 기술이 발전함에 따라 프로그램이 복잡해지고 다채로워짐으로써 프로세스 작업 하나 만을 사용해서 프로그램을 실행하기에 한계가 있었음
- 그렇다고 동일한 프로그램을 여러 개의 프로세스로 만들게 되면, 그만큼 메모리를 차지하고 CPU에서 할당받는 자원이 중복되게 될 것이다. 스레드(Thread)는 이러한 프로세스 특성의 한계를 해결하기 위해 탄생 하였다.

## 프로세스의 자원 구조
![image](https://github.com/user-attachments/assets/091f6c0f-3ba2-4817-9a28-992c17a3d234)
- 프로그램이 실행되어 프로세스가 만들어지면 다음 4가지 메모리 영역으로 구성되어 할당받게 된다
    - 코드 영역(Code/Text) : 프로그래머가 작성한 프로그램 함수들의 코드를 CPU가 해석한 기계어 형태로 저장되어있다.
    - 데이터 영역 (Data) : 코드가 실행되면서 사용하는 전역변수나 각종 데이터들이 모여있다. 데이터 영역은 .data, .rodata, .BSS 영역으로 세분화 된다
        - .data : 전역변수 또는 static 변수 등 프로그램이 사용하는 데이터를 저장
        - .BSS : 초기값 없는 전역변수 ,static 변수가 저장
        - .rodata : const같은 상수 키워드 선언된 변수나 문자열 상수가 저장
    - 스택 영역(Stack) : 지역 변수와 같은 호출한 함수가 종료되면 되돌아올 임시적인 자료를 저장하는 독립적인 공간. Stack은 함수의 호출과 함께 할당되며, 함수의 호출이 완료되면 소멸한다. 만일 stack 영역을 초과하면 stack overflow 에러가 발생한다.
- 위의 그림에서 Stack과 Heap 영역이 위아래로 화살표가 쳐 있는 것을 볼 수 있는데, 이는 코드 영역과 데이터 영역은 선언할 때 그 크기가 결정되는 정적 영역이지만, 스택 영역과 힙 영역은 프로세스가 실행되는 동안 크기가 늘어났다 줄어들기도 하는 동적 영역이기 때문에 이를 표현한 것이다.
- 프로그램이 여러개 실행된다면 메모리에 프로세스들이 담길 주소 공간이 생성되게 되고 그 안에 Code, Data, Stack, Heap 공간이 만들어지게 된다

## 프로세스의 자원 공유
- 기본적으로 각 프로세스는 메모리에 별도의 주소 공간에서 실행되기 때문에, 한 프로세스는 다른 프로세스의 변수나 자료구조에 접근할 수는 없다. 
- 그렇다면 프로세스는 영원히 다른 프로세스 정보에 접근할 수 없을까?
- 현재 우리가 사용하는 대부분의 컴퓨터 프로그램을 보면 다른 프로그램에 있는 정보를 가져오는 경우는 심심치 않게 볼 수 있을 것. 
- 이처럼 특별한 방법을 통해 프로세스가 다른 프로세스의 정보에 접근하는 것이 가능하다. 프로세스 간 정보를 공유하는 방법에는 다음과 같은 방법들이 있다.
    - IPC(Inter-Process Communication) 사용
    -  LPC(Local inter-Process Communication) 사용
    - 별도로 공유 메모리를 만들어서 정보를 주고받도록 설정
    ![image](https://github.com/user-attachments/assets/3304199e-9837-49d1-bf29-9df6223b2e3e)
- 그러나 프로세스 자원공유는 단순히 CPU 레지스터 교체뿐만 아니라 RAM과 CPU 사이의 캐시 메모리까지 초기화 되기때문에 자원부담이 크다는 단점이 있음. 그래서 다중 작업이 필요한 경우 스레드를 이용하는 것이 훨씬 효율적이라, 현대 컴퓨터 운영체제에선 다중 프로세싱을 지원하고있지만 다중 스레딩을 기본으로 하고있다. 

## 프로세스의 생명주기 프로세스 스케쥴링
- 프로세스 스케쥴링은 운영체제에서 CPU를 사용할 수 있는 프로세스를 선택하고, CPU를 할당하는 작업을 말한다. 프로세스 스케줄링은 프로세스의 우선순위, 작업량 등을 고려하여 효율적으로 배치하여, 이를 통해 운영체제는 CPU를 효율적으로 사용하며 시스템 전반적인 성능을 향상시킨다.
- 그래서 스케줄링은 멀티 태스킹 작업을 만들어내는 데에 있어서 핵심적인 부분
- 스케쥴링은 운영체제의 특징과 시스템 요구사항에 따라 다양한 알고리즘 방식으로 동작된다. 알고리즘 종류로는 대표적으로 FCFS(First-Come, First-Served), SJF(Shortest-Job-First), Priority, RR(Round-Robin), Multilevel Queue 등이 있다.
    ![image](https://github.com/user-attachments/assets/1ca13099-7e8a-4e14-8619-4fcfee81d71e)

## 프로세스 상태
- 프로세스의 상태는 프로세스가 실행되는 동안 변경되는 고유 상태를 의미한다. 프로세스가 생성되어 실행하기 까지 프로세스는 여러가지의 상태를 갖게 되고, 상태의 변화에 따라 프로세스가 동작되는 것이다. 프로세스는 일반적으로 다음과 같은 5가지 상태를 가진다
    - 생성(new) : 프로세스가 생성되고 아직 준비가 되지않은 상태
    - 준비(ready) : 프로세스가 실행을 위해 기다리는 상태, CPU를 할당 받을 수 있는 상태이며, 언제든지 실행될 준비가 되어있다.
    - 실행(running) : 프로세스가 CPU를 할당받아 실행되는 상태
    - 대기 (waiting) : 프로세스가 특정 이벤트(입출력 요청 등)가 발생하여 대기하는 상태 , CPU 할당을 받지못하며 이벤트가 발생하여 다시 ready 상태로 전환될때까지 대기한다.
    - 종료 (terminated) : 프로세스가 실행을 완료하고 종료된 상태, 더이상 실행될수없으며 메모리에서 제고 된다.

### 프로세스 상태 전이
- 프로세스 상태 전이란 프로세스가 실행되는 동안 상태가 OS에 의해 변경되는 것을 말한다. 운영체제는 프로세스의 상태를 감시하고, 프로세스 상태를 기반으로 프로세스 스케쥴링을 통해프로세스를 관리하고 제어한다. 예를 들어, READY 상태에 있는 여러 프로세스 중에서 어떤 프로세스를 RUNNING 상태로 바꿀지, TERMINATED 상태에 있는 프로세스를 제거하고 READY 상태에 있는 다른 프로세스를 선택할지 스케쥴링 알고리즘에 의해 동작된다.
![image](https://github.com/user-attachments/assets/ec36b283-9350-4634-9b07-7b55366f97e8)
    - Admitted (new → ready) : 프로세스 생성을 승인 받음
    - Dispatch (ready→ running) : 준비 상태에 있는 여러 프로세스들 중 하나가 스케줄러에 의해 실행됨
    - Interrupt (running → ready) : Timeout, 예기치 않은 이벤트가 발생하여 현재 실행 중인 프로세스를 준비 상태로 전환하고, 해당 작업을 먼저 처리
    - I/O or event wait (running → wainting) : 실행 중인 프로세스가 입출력이나 이벤트를 처리해야 하는 경우, 입출력이나 이벤트가 끝날 때까지 대기 상태로 전환
    -  I/O or event completion (waiting → ready) : 입출력이나 이벤트가 모두 끝난 프로세스를 다시 준비 상태로 만들어 스케줄러에 의해 선택될 수 있는 상태로 전환


# 스레드 
![image](https://github.com/user-attachments/assets/2f31986b-a4aa-42a1-8ad0-1a6bfedddd37)
- 프로세스가 할당받은 자원을 이용하는 실행 흐름의 단위
- **프로세스 내에서 동시에 진행되는 작업 갈래 흐름의 단위**
- 기술이 발전됨에 따라 프로그램이 복잡해지고 다채로워짐으로써 프로세스 작업 하나만을 사용해서 프로그램을 실행하기에는 한계가 있었다. 그렇다고 동일한 프로그램을 여러 개의 프로세스로 만들게 되면, 그만큼 메모리를 차지하고 CPU에서 할당받는 자원이 중복되게 될 것이다. 스레드(Thread)는 이러한 프로세스 특성의 한계를 해결하기 위해 탄생했다.
- 쉽게 말하면 크롬브라우저가 실행되면 프로세스 하나가 실행된 것. 크롬에서 파일을 다운받으면서 온라인 쇼핑을 한다 -> 스레드가 여러가 진행되고있는것
- 즉 하나의 프로세스 안에서 여러가지 작업 흐름이 동시에 진행되기때문에 가능한 것인데 이러한 인련의 작업 흐름들을 스레드라고 하며 여러개가 있다면 이를 멀티(다중) 스레드라고 부른다.
- 일반적으로 하나의 프로그램은 하나 이상의 프로세스를 가지고 있고, 하나의 프로세스는 반드시 하나 이상의 스레드를 갖는다. 즉, 프로세스를 생성하면 기본적으로 하나의 main 스레드가 생성되게 된다. 스레드 2개, 3개.. 는 프로그램을 개발한 개발자가 직접 프로그래밍하여 위치 시켜주어야 한다. 그래서 별도로 스레드 프로그래밍 과목이 있는 이유이기도 하다

## 스레드의 자원 공유
- 스레드는 프로세스가 할당 받은 자원을 이용하는 실행의 단위로서, 스레드가 여러개 있으면 우리가 파일을 다운 받으며 동시에 웹 서핑을 할 수 있게 해준다. 스레드끼리 프로세스의 자원을 공유하면서 프로세스 실행 흐름의 일부가 되기 때문에 동시 작업이 가능한 것이다. 그래서 아래 사진과 같이 하나의 프로세스 내에 여러개의 스레드가 들어있는 상태인 것이다.
- ![image](https://github.com/user-attachments/assets/5d1625d4-5df2-4645-84db-6e3003cb4fac)
- 이때 프로세스의 4가지 메모리 영역(Code, Data, Heap, Stack) 중 스레드는 Stack만 할당받아 복사하고 Code, Data, Heap은 프로세스내의 다른 스레드들과 공유된다. 따라서 각각의 스레드는 별도의 stack을 가지고 있지만 heap 메모리는 고유하기 때문에 서로 다른 스레드에서 가져와 읽고 쓸 수 있게 된다.
![image](https://github.com/user-attachments/assets/9fd2701f-9997-41f7-ab5f-a04388a7354e)
- 이렇게 구성한 이유는 하나의 프로세스를 다수의 실행 단위인 스레드로 구분하여 자원을 공유하고, 자원의 생성과 관리의 중복성을 최소화하여 수행 능력을 올리기 위해서다.
- stack은 함수 호출 시 전달되는 인자, 되돌아갈 주소값, 함수 내에서 선언하는 변수 등을 저장하는 메모리 공간이기 때문에, 독립적인 스택을 가졌다는 것은 독립적인 함수 호출이 가능하다 라는 의미이다. 그리고 독립적인 함수 호출이 가능하다는 것은 독립적인 실행 흐름이 추가된다는 말이다.즉, stack을 가짐으로써 스레드는 독립적인 실행 흐름을 가질 수 있게 되는 것이다
- 반면에 프로세스는 기본적으로 프로세스끼리 다른 프로세스의 메모리에 직접 접근할 수 없다.

### 질문
#### 스레드는 프로세스의 자원을 공유하면서 독립적인 실행 흐름을 가질 수 있는데, 이를 통해 얻는 장점은 무엇인가요?
- 스레드는 프로세스 내 자원을 공유하므로 메모리와 CPU 자원의 중복 사용을 줄일 수 있습니다. 동시에 독립적인 실행 흐름을 가질 수 있어 병렬 작업이 가능하며, 파일 다운로드와 웹 서핑 같은 멀티태스킹 작업을 효율적으로 처리할 수 있습니다.

#### 스레드가 독립적인 스택을 가지는 이유는 무엇이며, 이로 인해 어떤 기능이 가능해지나요?
- 스레드가 독립적인 스택을 가지는 이유는 함수 호출 시 사용하는 인자, 반환 주소, 지역 변수를 별도로 저장하기 위해서입니다. 이를 통해 각 스레드는 독립적인 함수 호출이 가능하며, 독립적인 실행 흐름을 형성하여 멀티스레드 환경에서 동시다발적인 작업을 처리할 수 있습니다.

참고링크 : 
https://inpa.tistory.com/entry/%F0%9F%91%A9%E2%80%8D%F0%9F%92%BB-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%E2%9A%94%EF%B8%8F-%EC%93%B0%EB%A0%88%EB%93%9C-%EC%B0%A8%EC%9D%B4

