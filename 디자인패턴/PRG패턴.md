# 멱등성
- 동일한 요청을 여러번 연속해서 보낼 때 한번 보내는 것과 여러 번 연속해서 보내는 것의 결과가 같은 것을 의미한다. GET, HEAD, PUT, DELETE는 멱등성을 가지지만,POST는 멱등성을 가지지 않는다.
- GET 메소드를 연달아 호출해도 같은 결과를 나타내지만, 게시글을 등록하는 POST를 연달아 호출하면 호출한 횟수만큼의 게시글이 등록된다. (별도 처리를 하지 않은 상황 기준) 혹은, Servlet에서 게시글 작성이나 주문을 POST로 전송 후 해당 요청에 대한 응답으로 redirect가 아닌 forward로 처리할 경우 새로고침 시 게시글 작성/주문이 중복해서 처리될 수 있다.

## PRG 패턴의 필요
- 회원가입, 게시글 등록, 메뉴 주문 등은 대부분 POST를 통해 이루어지기때문에 새로 고침을 한다해서 여러번 행위가 반복되서는 안된다. 때문에 PRG 패턴이 권장된다.

# PRG 패턴( Post-Redirect_Get)
- 웹개발 패턴 중 자주 쓰이는 패턴으로 HTTP POST 요청에 대한 응답이 또다른 URL로의 GET요청을 위한 리다이렉트(응답코드 3XX)여야한다는 것을 의미한다. 
- 즉, 쉽게 설명하면 POST 방식으로 온 요청에 대해서 GET 방식의 웹페이지로 리다이렉트 시키는 패턴을 말한다. 
- POST → Redirect → GET 의 패턴을 권장하기에 줄여서 PRG라고 한다. POST 요청이 오면 해당 요청을 수행한 후 Redirect를 시켜서 GET 요청으로 변환시키는 행위를 의미한다.
- 게시글을 등록(POST)하는 요청을 보냈다면, 게시글 등록 후 해당 게시글이 다른 유저에게 보여지는 화면으로 redirect시키는 방법이다. 이런 방법을 사용하면 Redirect를 시킴으로써 새로고침을 하더라고 동일 행위가 중복 요청되지 않도록 방지할 수 있고 URL을 통해 요청을 보낸 사용자가 POST 요청의 결과에 해당하는 페이지를 다른 사용자와 공유할 수도 있다.
    -  1. POST: 사용자가 웹 양식을 작성하고 제출하면, 데이터는 POST 요청을 통해 서버로 전송된다.
    - 2. Redirect: 서버는 데이터를 처리한 후, 사용자를 다른 페이지로 리다이렉트(예: 성공 페이지, 리스트 페이지 등)한다. 이때 리다이렉트는 GET 요청을 사용한다.
    - 3. GET: 브라우저는 서버로부터 받은 리다이렉션 지시에 따라 GET 요청을 하여 새 페이지를 로드한다.
- 이 패턴의 핵심은 POST 요청으로 데이터를 전송한 직후에 브라우저가 새로고침을 하더라도 GET 요청만 다시 수행되기 때문에, 데이터가 중복으로 서버에 전송되는 것을 방지하다는 것이다.

## PRG 패턴을 사용하지 않으면 발생하는 문제점
- 첫번째로 새로고침으로 인한 동일한 요청이 연속적으로 보내지는 이슈가 발생한다는 것이다. 만약 이 이슈가 중요하지 않은 로직이 있는 부분이라면 상관없겠지만 결제 같은 중요한 로직에서는 중복 결제가 일어나는 문제가 발생한다.
- 두 번째로는 POST 요청은 URL을 복사하더라도 다른 사람과 공유할 수 없다는 점이 문제가 된다. POST 요청을 보내게 되면 Parameter 값들이 URL에 남겨있지 않기에 특정 Paramter 가 필요한 POST 요청인 경우 URL을 복붙 하더라도 에러 페이지만 보이게 될 것이다.

## PRG 패턴의 한계
- 리디렉션이 추가됨에 따라 네트워크 요청이 한번 더 발생한다. 이는 서버와 클라이언트 사이의 통신 비용을 증가 시킬 수 있다. 하지만 대부분의 경우, 데이터 중복 문제를 방지하는 이점이 이러한 성능 손실을 상쇄하기때문에 PRG 패턴이 사용되고있다.

### 질문
#### 왜 PRG 패턴이 데이터 중복 문제를 방지할 수 있나요?
- PRG 패턴은 POST 요청 직후 클라이언트를 GET 요청으로 리다이렉트시키기 때문에 새로고침(F5)으로 인해 동일한 POST 요청이 반복되지 않도록 방지합니다. POST 요청의 결과는 서버 처리 후 GET 요청으로 변환되므로, 클라이언트는 새로고침 시 GET 요청만 반복하게 됩니다. 이를 통해 중복 데이터 전송 문제를 해결할 수 있습니다.

#### PRG 패턴을 적용하지 않고도 POST 요청의 중복 처리를 방지할 수 있는 다른 방법은 없나요?
- PRG 패턴 외에도 CSRF 토큰이나 중복 요청 방지 로직을 통해 POST 요청의 중복 처리를 방지할 수 있습니다. 예를 들어, 서버는 POST 요청마다 고유한 토큰을 생성하여 동일한 토큰으로 중복 요청이 처리되지 않도록 할 수 있습니다. 또한, 서버는 동일한 데이터가 중복 처리되지 않도록 요청 데이터의 상태를 검증하거나 특정 요청 ID를 기준으로 중복 여부를 판단할 수도 있습니다.

---

참고링크 

https://programmer93.tistory.com/76

https://gofo-coding.tistory.com/entry/PRG-%ED%8C%A8%ED%84%B4-Post-%E2%86%92-Redirect-%E2%86%92-Get

https://sharonprogress.tistory.com/285