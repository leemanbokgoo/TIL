

## Stream 중간 연산
![Image](https://github.com/user-attachments/assets/e486e00c-878d-4b47-9967-c54121a5fdf1)

- Java의 Stream API에서 중간 연산(Intermediate Operation) 은 스트림의 요소들을 변환, 필터링, 정렬하는 등의 작업을 수행하는 연산.
-  객체의 Stream을 생성하고 중간 연산을 수행하고 최종 연산을 하여 결과값을 얻는다.

```
객체.Stream생성().중간연산.최종연산()

```
## 중간연산 특징
- 지연 실행(Lazy Evaluation) → 최종 연산(Terminal Operation)이 호출될 때까지 실행되지 않음.
- 스트림을 반환 → 기존 스트림을 변경하지 않고 새로운 스트림을 반환하여 연속적인 연산이 가능함.
- 무한 스트림 처리 가능 → 필요한 만큼만 계산하기 때문에 무한 스트림을 다룰 수 있음.

## 중간 연산 종류
### Stream 필터 :: filter(), distinct()	
### filter()
- filter()는 구성한 스트림 내에서 특정 조건에 맞는 결과값을 필터링 하기 위해 사용하는 중간연산. 내부적으로 각 요소를 하나씩 평가하며, 조건을 충족하는 요소만 새로운 스트림으로 전달한다.
- Stream의 filter()는 주어진 조건을 만족하는 요소만 걸러내는 중간 연산(Intermediate Operation) 입니다. 내부적으로 각 요소를 하나씩 평가하며, 조건을 충족하는 요소만 새로운 스트림으로 전달합니다.
- filter()는 주어진 조건을 만족하는 요소만 걸러내는 중간 연산이다. 각 요소를 하나씩 검사하며, 조건을 충족하는 경우에만 새로운 스트림으로 전달한다. 이 연산은 지연 실행(Lazy Evaluation) 방식으로 동작하기 때문에, 최종 연산이 호출될 때까지 실제로 실행되지 않는다. 또한, 첫 번째 조건 만족 요소만 찾는 연산과 함께 사용하면 불필요한 연산을 줄일 수 있다. 결과적으로 filter()는 원본 데이터를 변경하지 않고 필요한 요소만 선별하는 효율적인 스트림 연산이다.

### distinct()
- distinct()는 구성한 스트림 내에서 중복을 제거한 결과값을 반환하기 위해 사용.

### Stream 변환	:: map(), flatMap()	

### map()
- map()은 구성한 스트림 내에서 요소들을 원하는 값으로 변환하여서 반환하기 위해 사용.
- map()은 단일 스트림의 원소를 매핑시킨 후 매핑시킨 값을 다시 스트림으로 변환하는 중간 연산을 담당한다. 객체에서 원하는 원소를 추출해는 역할을 한다고 말할 수 있다. 
- map()은 스트림에 접근해서 사용자가 원하는 매핑을 실행해주는 메서드이다. "리스트 안에 있는 각각의 항목을 변환해서 다른 값으로 바꾼다."
- 변환만 하고 모양(구조)는 유지한다. 한개씩 작업할 때 사용ㅎ암
- 필터가 조건을 충족시키는 새로운 스트림을 생성한다면, Map은 각각의 아이템을 변경하여 새로운 컨텐츠를 생성하는 기능이다.
- 데이터 하나를 다른 하나로 변환 시킨다 하나가 들어오면 하나 나가는 방식. 1:1 변환

### flatMap()
![image](https://github.com/user-attachments/assets/46297e51-93a2-4fcc-b46f-77a927244b39)
- flatMap()는 구성한 스트림 내에서 중복된 스트림을 평면화(flattern)하여 요소를 구성하여 반환하기 위해 사용.
- flatMap()은 Array나 Object로 감싸져 있는 모든 원소를 단일 원소 스트림으로 반환.
- 데이터하나를 여러개로 나누거나 여러 데이터를 하나로 합친다. 여러개 들어가고 평평한 하나로 나오는 구조(flat)이라고 생각하면 됨.
- 여러개 나눠진것을 평평하게 합친다 -> 묶여있는 걸 풀어서 작업할떄 사용.
- map()은 입력한 원소를 그대로 스트림으로 반환하지만 .flatMap()은 입력한 원소를 가장 작은 단위의 단일 스트림으로 반환
- 단도직입적으로 말하면, flatMap()은 다중 스트림을 평탄화하는 역할을 한다. 즉, 다중 스트림을 하나의 스트림으로 합친다는 뜻이다.
- flatMap() 은 여러개의 스트림을 한개의 스트림으로 합쳐준다. 복잡한 스트림을 간단한 스트림으로 변경되는데 사용할 수 있다. 예를들어 아래 코드에서는 Stream<String[]>를 Stream<String> 형태로 변환했다.

### Stream 제한	:: limit(), skip()	
### limit()
- limit()는 구성한 스트림 내에서 요소의 개수를 제한하여 반환해주기 위한 목적으로 사용.
### skip()
- skip()는 구성한 스트림 내에서 시작부터 특정 n개의 요소를 제외하여 반환해주는 목적으로 사용.

### Stream 정렬	:: sorted()	
### sorted()
- sorted()는 구성한 스트림 내에서 배열 혹은 리스트 그리고 Object의 요소에 대해서 오름/내림 차순을 수행하여 반환해주는 함수.

### Stream 연산 결과 확인 :: peek()	
### peek()	
- peek()는 구성한 스트림 내에서 각각의 요소를 조회하는 연산자료 요소 자체를 추출하는것이 아닌 스트림의 요소를 조회하는 함수.


## Stream 최종연산
![Image](https://github.com/user-attachments/assets/617e3de0-f6a4-4985-82e6-d27f71da8fd3)
- Java의 Stream API에서 최종 연산(Terminal Operation) 은 스트림의 모든 요소를 소비(consume)하고, 결과를 반환하는 연산이이다. 즉, 최종 연산을 호출하면 스트림이 종료되고, 더 이상 다른 연산을 적용할 수 없다.

## 특징
- 최종 연산이 호출되기 전까지는 스트림이 지연 실행(Lazy Evaluation) 됨.
- 최종 연산을 수행하면 스트림이 닫히므로 재사용할 수 없음.
- 최종 연산에는 값을 반환하는 연산과 부수적인 효과(Side Effect)를 수행하는 연산이 있음.

## 최종연산 종류
### 요소의 출력	:: forEach()	
### forEach()
- forEach()는 배열 혹은 리스트 내에서 순회를 하며 요소에 대한 값을 얻어서 요소에 대한 출력 혹은 값을 새로운 형태로 변환하여 구성을 하기 위한 목적으로 사용이 .

### 요소의 검색 :: findFirst(), findAny()
### findFirst()
- findFirst()는 스트림 내에서 조건에 “일치하는 요소들 중”에서 “가장 앞에 있는 요소”를 리턴해주는데 사용되는 함수.
###  findAny()
- findAny()는 스트림 내에서 조건에 “일치하는 요소들 중”에서 “먼저 탐색되는 요소”를 리턴해주는데 사용하는 함수.

### 요소의 검사	:: anyMatch(), allMatch(), noneMatch()	
### anyMatch()
- anyMatch()는 스트림 내의 요소들 중 주어진 조건에 맞는 요소가 “하나 라도 맞는다면” true의 값을 반환해주는데 사용하는 함수.

### allMatch()
- allMatch()는 스트림 내의 요소들 중 “모두 해당 조건에 맞는지”에 대해 판단하여 모두 맞으면 true 값을 반환해주는데 사용하는 함수.

### noneMatch()	
- noneMatch()는 스트림 내의 요소들 중 “주어진 조건에 맞는 요소가 없는지”에 대해 판단하여 모두 없다면 true 값을 반환해주는데 사용하는 함수. 

### 요소의 통계 :: count(), min(), max()	
### count()
- count()는 스트림 내의 요소들 중 총 요소의 개수를 반환해주는데 사용하는 함수.
### min()
- min()는 스트림 내의 요소들 중 “가장 작은 값”을 반환해주는데 사용하는 함수.
### max()
- max()는 스트림 내의 요소들 중 “가장 큰 값”을 반환해주는데 사용하는 함수.

### 요소의 연산 :: sum(), average()
###	sum()
- sum()은 스트림 내의 모든 요소들을 더하여 하나의 값으로 반환해주는 함수.
###	average()
- average()는 스트림 내의 요소들의 평균 값을 계산해주어 하나의 값으로 반환해주는 함수. 

### 요소의 수집 :: ollect()	
### collect()
- collect()는 스트림 내의 모든 요소들을 수집하여 사용자가 원하는 형태로 변환하는데 사용하는 메소드.
- collect()는 스트림의 요소들을 컬렉션으로 변환하는 최종 연산이다. 주로 Collectors.toList(), Collectors.toSet() 등을 사용하여 스트림의 결과를 리스트나 세트로 모을 수 있다.
- 동작 원리는 스트림의 각 요소를 주어진 수집기(Collector)에 맞게 누적한 후, 최종적으로 컬렉션을 반환하는 방식. 간단히 말해, 스트림에서 처리된 데이터를 원하는 형태로 모을 수 있는 연산이다.

## 최종연산과 중간 연산의 차이
- 중간 연산(Intermediate Operation) 은 스트림을 변환하거나 필터링하는 과정에서 사용되며, 즉시 실행되지 않고 최종 연산이 호출될 때 한꺼번에 처리된다. 즉, 지연 실행(Lazy Evaluation) 이 특징이다. 예를 들면 filter(), map(), sorted() 같은 연산이 있다.
- 최종 연산(Terminal Operation) 은 스트림의 모든 요소를 소비(consume) 하고 하나의 결과를 반환하거나 부수적인 작업을 수행하며, 실행되면 스트림이 더 이상 사용할 수 없게 된다. count(), collect(), reduce(), forEach() 같은 연산이 이에 해당한다.


### 질문
####  Lazy Evaluation이 Java Stream에서 성능 최적화에 어떤 방식으로 기여할 수 있는가?
- Lazy Evaluation은 중간 연산의 실행을 지연시키고 최종 연산이 호출될 때만 연산을 수행합니다. 이를 통해 연산에 필요한 데이터만 처리하며, 루프퓨전(loop fusion)을 통해 연속된 연산을 병합하고 쇼트서킷(short circuit)을 활용하여 불필요한 연산을 생략함으로써 성능을 최적화합니다.

#### map()과 flatMap()의 주요 차이점은 무엇이며, flatMap()이 필요한 상황은 어떤 경우인가?
- map()은 1:1 매핑으로 각 데이터를 변환하지만, 원소의 구조를 유지합니다. 반면, flatMap()은 다중 스트림을 하나의 단일 스트림으로 평탄화(flatten)하며, 복잡한 데이터 구조를 단순화하는 데 사용됩니다. 예를 들어, 배열이나 중첩된 컬렉션을 단일 스트림으로 변환해야 할 때 flatMap()을 사용합니다.

#### 중간 연산과 최종 연산의 차이점은 무엇인가요?
- 중간 연산은 스트림을 변환하거나 필터링하는 작업을 수행하며, 지연 실행(Lazy Evaluation) 방식으로 동작합니다. 즉, 최종 연산이 호출될 때까지 실제로 실행되지 않습니다. 반면, 최종 연산은 스트림의 요소를 소비하고 하나의 결과를 반환하거나 부수적인 작업을 수행하며, 스트림을 종료시키고 더 이상 사용할 수 없게 만듭니다. 예를 들어, filter(), map() 등은 중간 연산이고, collect(), count(), forEach() 등은 최종 연산입니다.

#### collect() 최종 연산의 동작 원리는 어떻게 되나요?
- collect()는 스트림의 요소들을 컬렉션으로 변환하는 최종 연산입니다. 스트림의 각 요소를 주어진 수집기(Collector)에 맞게 누적하고, 최종적으로 컬렉션을 반환합니다. 예를 들어, Collectors.toList()를 사용하면 스트림의 요소들이 리스트로 변환됩니다. 이 연산은 스트림을 변환하는 과정에서 결과를 집합체로 모을 수 있는 방법을 제공하는 매우 중요한 연산입니다.

---

참고링크 

https://linked2ev.github.io/java/2023/12/01/Java-Stream-collect-%EC%B5%9C%EC%A2%85%EC%97%B0%EC%82%B0%EA%B3%BC-Collector-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4/

https://adjh54.tistory.com/109

https://bugoverdose.github.io/development/stream-lazy-evaluation/

https://unagi-zoso.tistory.com/283

https://adjh54.tistory.com/109

https://adjh54.tistory.com/110?category=1147554