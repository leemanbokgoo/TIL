# Sticky Session
- MSA 아키텍처의 경우 서버가 여러개가 있음 -> 이런 환경에서 요청을 적절하게 분산 하기위해서 로드 밸런서를 활용. 이러한 분산된 환경에서 세션의 사용은 어렵다. 세션은 사용자 웹사이트를 방문할때 서버측 저장되는 일시적인 데이터이기때문에 부산된 환경에서 각각의 물리적인 서버의 세션이 별도로 관리됨.
- Sticky Session은 이러한 단점을 극복하기위해서 등장한 개념. 스티키 세션은 로드밸런싱 환경에서 사용되는 세션관리전략. 이 전략의 목적은 사용자의 요청을 항상 동일한 서버로 라우팅하여 사용자의 세션 데이터의 일관성을 유지하는 것.
- 예를 들어 서버 A,B,C가 있다고 할때 유저 1이 서버 A에 로그인을 요청해서 유저1의 세션을 서버 a에게 저장하고 앞으로 유저 1의 모든 요청은 서버 A에서 담당하는 것.

## 특징
- 세션의 일관성
    - 사용자가 서버에 세션을 생성하면 해당 세션은 특정 서버와 붙어(Sticky)있게 된다. 사용자의 후속 요청들은 모두 동일한 서버로 라우팅됨.
- 로드밸런서의 역할
    - 로드 밸런서는 사용자의 요청을 받아 처음 요청을 처리한 서버로 후속 요청을 계속 전달하게된다. 이는 쿠키 IP주소, 또는 다른 세션 식별자를 사용하여 구현 될 수 있음.
    - 각 서버는 자신에게 할당된 사용자의 세션 데이터를 로컬에 저장, 이는 네트워크 오버헤드를 줄이고 세션 접근 속도를 향상시킴
- 서버 간의 세션 데이터 공유 부재
    - 스티키 세션을 사용하는 경우, 다른 서버들은 사용자의 세션 데이터에 접근할 수 없다. 따라서 사용자는 붙어있는 서버에 문제가 생길 경우 세션 데이터가 유실 될수있음.

## 장점
- 세션 데이터에 대한 빠른 접근이 가능
- 복잡한 세션 데이터 관리 및 동기화 매커니즘이 필요 없음
- 서버간의 세션 데이터 공유에 따른 오버헤드를 피할 수 있음
## 단점
-  서버 장애 시 세션 데이터가 유실될 위험이 있음
- 로드 밸런싱의 효율성이 감소될수 있음 특정 서버에 과부하가 걸릴 수 있음
- 확장성에 제한이 있을 수있다. 세션데이터가 서버에 종속 되기때문에 수평적 확장이 어렵다.
- 특정서버에 과부하가 걸려서 해다 ㅇ요청이 결국 다른 서버에 보내야되는 상황이 발생한다면 사용자의 데이터는 날라가고 재로그인을 요구할 수 밖에 없음.

# Session Clustering
- 이런 단점을 극복 하기위해 나온것이 세션 클러스터링. 각 서버가 가지고있는 세션들을 공유하여 관리하는 것을 의미 -> 고가용성과 확장성을 제공
- 다중 서버 환경에서 로드 밸런서를 통해 어떤 서버로 접속하든지 세션이 동일하게 유지되도록 설정해주는 것
## DelaManger
- 특정 서버에 발생한 SESSION정보를 나머지 모든 서버에 복제 -> 비용이 크기때문에 대규모 클러스터 환경에는 적합하지않음

## BackupManager 
- 서버 4개 이상의 경우 이용 -> 특정 서버에서 발생한 SESSION 정보를 나머지 서버들중 오직 1대에만 복제, 나머지 3대의 서버들은 프록시 노드가 되서 SESSION ID, 기본, 백업 서버의 주소가 들어감.
- 1번 서버 : Session 생성 | 2번 서버 : Session복제  | 3번서버 : 1번서버 값  | 4번서버 2번서버값
- 이후 사용자가 1,2번 서버에 접속하면 이미 해당 Session정보가 있어서 바로 서비스를 제공.
- 3,4,번 서버의 Session 정보를 조회후에 서비스를 제공.
- 세션 클러스터링 방식은 서버가 늘어날 수록 늘어나는 서버의 갯수만큼 세션 정보를 복제해야하기때문에 서버를 추가함에 대하나 부하가 있고 성능확장에 한계가 있습니다. 한계를 극복하기위해서는 Redis나 Memcached와 같은 인메모리 DB를 사용합니다.

참고링크 

https://velog.io/@jeongbeom4693/Security-Sticky-Session-Session-Clustering
