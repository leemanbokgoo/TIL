# docker
- Docker란 Go언어로 작성된 리눅스 컨테이너 기반으로하는 오픈소스 가상화 플랫폼이다. 현재 Docker 0.9버전 부터는 직접 개발한 libcontainer 컨테이너를 사용하고 있다. 
- 도커를 이용하면 이미지를 실행시켜 컨테이너로 만들거나, 생성된 컨테이너를 관리하거나, 컨테이너를 다시 이미지로 만드는 작업을 쉽게 할 수 있다.
- 도커는 아주 강력한 도구로 개발 과정에서 다른 라이브러리와 충돌하는 것을 방지하기 위해 격리된 환경이 필요할 때, 완성된 서비스를 배포할 때, 혹은 배포 중인 서비스를 받아서 실행해 볼 때도 유용하다. 특히 배포 과정에서 도커를 사용해 필요한 파일들만 예쁘게 포장해서 이미지로 만들면 종속성 이슈에서 벗어날 수 있습니다. 
- 서버 한 대에만 배포한다면 종속성은 큰 문제가 되지 않겠지만 수백, 수천 대의 서버에 배포하게 되는 경우 똑같은 일을 반복해야한다. 파일 받고, 필요한 라이브러리 설치하는 과정을 생략 할 수 있는 것이다. 도커를 사용하면 그냥 같은 이미지를 실행해서 컨테이너로 만들면 된다.

## docker 관련 용어 
### 가상화
- 물리적인 서버 하나를 여러 개의 가상 서버로 쪼개서 여러개의 서버를 올릴 수 있는 기술이다. 서버 운영을 효율적으로 하기 위해 한 대의 물리적인 서버를 마치 여러 대의 서버처럼 활용하거나 여러 서버를 하나의 서버처럼 묶어서 사용할 수 있다.
- 가상화는 가상화를 관리하는 소프트웨어(주로 Hypervisor)를 사용하여 프로세서, 메모리, 스토리지 등과 같은 단일 컴퓨터의 하드웨어 요소를 일반적으로 가상 머신(VM, Virtual Machine)이라고 하는 다수의 가상 컴퓨터로 분할할 수 있도록 해주는 컴퓨터 하드웨어 상의 추상화 계층을 구축하는 기술이다. 실제 기반 컴퓨터 하드웨어의 단지 일부에서만 실행됨에도 불구하고, 각각의 VM은 자체 운영체제(OS)를 실행하며 마치 독립적인 컴퓨터인 것처럼 작동한다.

### 컨테이너
- 애플리케이션과 그 실행에 필요한 모든 의존성(라이브러리, 바이너리, 설정 파일 등)을  하나의 패키지로 묶어 어디서나 일관되게 실행할 수 있게 해주는 경량화된 가상화 기술이다. 컨테이너는 가상화된 공간을 생성하기 위해 리눅스 네임스페이스(namespace)와 cgroups를 사용해 자원을 격리하고 제한해
프로세스 단위의 격리 환경을 만든다.
- 컨테이너 엔진이 호스트 OS 위에서 실행되고 컨테이너들은 호스트 OS 커널을 공유한다. (메모리 사용량이 적고 시작이 빠르다.) 또한 이러한 특성으로 컨테이너는 호스트와 동일한 OS 커널이 필요하다. (Linux 호스트에서는 Linux 컨테이너만 실행 가능) 컨테이너안에는 애플리케이션을 구동하는데 필요한 라이브러리 및 실행 파일만 존재하므로, 이미지를 만들었을 때 이미지의 용량이 가상 머신에 비해 훨씬 작다. 이미지의 용량이 작기 때문에 이미지를 만들어 배포하는 시간이 빠르고, 가상화된 공간을 사용했을 때 성능 손실도 거의 없다.
- 만약 10개의 애플리케이션을 실행한다면 VM과 다음과 같은 차이가 있다.
    - VM 방식: 10개의 완전한 OS를 실행 (10개의 커널, 10개의 모든 시스템 프로세스) = 10개의 완전한 컴퓨터를 켜는 것과 비슷
    - 컨테이너 방식: 1개의 OS 커널 위에 10개의 격리된 프로세스 실행 - 1대의 컴퓨터에서 10개의 앱을 실행하는 것과 비슷
- 이 컨테이너 가상화의 대표적인 기술이 바로 Docker이다.

## Docker의 특징
- docker는 성능향상, 뛰어난 이식성, 쉽게 Scale Out 할 수 있는 유연성을 가지고있다.

### 격리(Isolation)
- Docker는 프로세스를 격리된 환경에서 관리한다. 격리된 환경이란 Host OS 와의 격리를 의미하며 컨테이너에 어떠한 설정을 하든  Host OS에 영향을 끼치지않는다. 독립된 개발 환경을 보장받는 것이다. 
- Docker를 사용함으로써 프로세스를 컨테이너 단위로 사용할 수 있게 되어 각 애플리케이션과 그와 관련된 의존성 및 설정 파일 등을 완전히 분리하여 지원되어 이러한 격리로 인해 서로 다른 애플리케이션 간의 충돌 및 호환성 문제를 방지한다.
- 프로세스의 관리, 확장이 용이 해진다.
 
### 이식성(Portability)
- Docker로 만들어진 컨테이너는 Docker가 설치된 모든 환경에서 동일하게 실행된다.
    - 컨테이너는 호스트 OS의 커널을 사용해 하드웨어와 통신한다.
    - 따라서 직접 하드웨어와 상호작용하지 않고, OS가 제공하는 표준화된 인터페이스를 사용해 기본 하드웨어와 무관하게 작동할 수 있다.
    - 이를테면 개발을 진행한 로컬 환경의 애플리케이션을 다른 서버 환경으로 쉽게 옮겨 실행할 수 있게 한다.
 
### 경량(Lightweight)
- VM처럼 전체 OS를 가상화하지 않아 메모리 사용량이 크게 줄어든다. 애플리케이션이 동작하는데 필수적인 실행 가능한 파일과 라이브러리만 포함해 작은 크기의 이미지를 가질 수 있다. VM과 다르게 컨테이너는 필요할 때만 자원을 사용하고, 필요하지 않을 때는 반환한다.
- 또한 이미 실행 중인 호스트 커널을 그대로 활용하기 때문에 새로운 커널을 시작하지 않고, 기존 커널에 작업을 위임해 마치 한 명의 관리자가 여러 부서를 효율적으로 관리할 수 있다.

## Docker의 장점
### 모듈성
- 도커의 컨테이너 방식은 전체 애플리케이션을 분해할 필요없이, 애블리케이션의 일부를 분해하고 업데이트 또는 복구할 수 있게 해준다. 사용자는 MSA 기반 접근 방식 외에도 SOA(service-oriented architecture)의 작동 방식과 동일하게 멀티플 애플리케이션 사이에서 프로세스를 공유할 수 있다.

### 레이어 저장 방식
- 도커 이미지는 컨테이너를 실행하기 위한 모든 정보를 가지고 있기 때문에 보통 용량이 수백메가MB에 이른다. 처음 이미지를 다운받을 땐 크게 부담이 안되지만 기존 이미지에 파일 하나 추가했다고 수백메가를 다시 다운받는다면 매우 비효율적일 수 밖에 없다.
- 도커는 이런 문제를 해결하기 위해 레이어라는 개념을 사용하고 유니온 파일 시스템을 이용하여 여러 개의 레이어를 하나의 파일시스템으로 사용할 수 있게 해준다. 이미지는 여러 개의 읽기 전용read only 레이어로 구성되고 파일이 추가되거나 수정되면 새로운 레이어가 생성된다.
- 예를들어 a+b+c의 집합인 도커 이미지 A가 있다고 가정할 때, 이미지 A를 베이스로 만든 이미지 B는 a+b+c+B가 된다. 또한 도커 이미지 C를 이미지 B를 기반으로 만들었다면, 이미지C는 a+b+c+B+C 레이어로 구성된다. 이미지C 소스를 수정하면 a, b, c, B를 제외한 C(v2)만 레이어만 다운 받으면 되기 때문에 굉장히 효율적으로 이미지를 관리할 수 있다.
- 컨테이너를 생성할 때도 레이어 방식을 사용하는데 기존의 이미지 레이어 위에 읽기/쓰기 레이어를 추가한다. 이미지 레이어를 그대로 사용하면서 컨테이너가 실행중에 생성하는 파일이나 변경된 내용은 읽기/쓰기 레이어에 저장되므로 여러개의 컨테이너를 생성해도 최소한의 용량만 사용한다.

### 신속한 배포
- 도커 이미지 설명할 때 언급했지만 도커기반 컨테이너는 배포 시간을 몇 초로 단축할 수 있다. 각 프로세스에 대한 컨테이너를 생성함으로써 사용자는 유사한 프로세스를 새 앱과 빠르게 공유할 수 있다. 또한, 컨테이너를 추가하거나 이동하기 위해 OS를 부팅할 필요가 없으므로 배포 시간이 크게 단축된다. 이뿐만 아니라 배포 속도가 빨라 컨테이너에서 생성된 데이터를 비용 효율적으로 쉽게 생성하고 삭제할 수 있고 사용자는 우려를 할 필요가 없다.

### 버전 관리
- Docker는 이미지 빌드와 배포를 위한 버전 관리를 제공한다.
- 이미지는 여러 레이어로 구성되며, 변경 사항에 대해 새로운 레이어를 추가하여 효율적인 빌드와 저장 상황을 제공한다.
 
### 커뮤니티 및 이미지 공유
- Docker Hub를 통해 다양한 Docker  이미지를 제공한다.
- 또한 사용자는 자신만의 Docker 이미지를 만들어 공유할 수 있다.


## Docker 기능?
### Docker Image
- Docker Image란 서비스 운영에 필요한 애플리케이션, 소스코드, 라이브러리, 실행파일, 설정 값들을 묶어서 가지고 있는 것이다. 즉, 애플리케이션을 행하기 위한 모든 요소를 포함하고 있는 것이다. 컨테이너를 실행할 수 있는 실행파일, 설정 값 들을 가지고 있는 것이라고 생각 하면 된다. mage를 컨테이너에 담고 실행을 시킨다면 해당 프로세스가 동작하게 된다.
- Docker 이미지들은 github과 똑같이 Docker Hub 사이트를 통해 버전관리 및 배포 Push, Pull이 가능하다.
    - Docker Hub 사이트에서 다양한 컨테이너 이미지를 사용할 수 있는데, 여기서 Nginx 도커 이미지를 다운받고 실행시키면 Nginx가 바로 실행되는 것이다.

### DockerFile
- 도커 이미지를 만들기 위해서는 도커 파일이 필요하다. 도커 파일을 이용해 이미지를 구성하기 위한 명령어들을 작성하여 이미지를 구성할 수 있다. 
- 도커파일은 이미지를 생성하기 위한 스크립트 파일이다. 주로 텍스트 형식의 명령어들로 구성되어 있으며, 이를 사용하여 이미지 빌드 과정을 자동화하고 문서화할 수 있다.

### Docker Container
- 도커 컨테이너는 도커 이미지로 생성할 수 있으며, 도커 이미지와 컨테이너는 1 : N 관계를 갖는다. 즉, 하나의 이미지로 여러 컨테이너를 생성할 수 있는 것이다.
- 이미지를 실행하여 컨테이너를 생성하면, 도커 파일로 작성된 해당 이미지의 목적에 맞게 프로세스 단위의 격리 환경에 컨테이너가 생성된다.


## docker와 VM( Virtual Machine)의 차이.
- Docker랑 가상머신(VM)이랑 혼동하기 쉽다.둘의 차이점은 개발환경 OS의 유무이다. Docker은 기존의 OS위에서 Container Engine을 통해 가상환경을 만들어 개발한다. VM은 가상환경을 만들때마다 OS를 설치하고 그 위에 개발한다.
- VM은 새로운 OS를 설치하고 그에 필요한 세부적인 프로그램이 또 필요해서 용량을 많이 차지한다. 하지만 docker은 기존의 OS위에 바로 이용하기 때문에 용량을 덜 차지한다. 그렇게 때문에 부팅 하는데 시간이 덜 걸린다.

- 기존 가상화 기술인 가상머신은 하이퍼바이저를 이용해 여러개의 운영 체제를 하나의 호스트에서 생성해서 사용하는 방식이다. 이러한 여러개의 운영체제는 가상 머신이라는 단위로 구별되고 각 가상머신에는 우분투,CentOS 등의 운영체제가 설치되어 사용된다. 그래서 하이퍼 바이저에 의해 생성되고 관리되는 운여체제는 게스트 운영체제라고 하며 각 게스트 운영체제는 다른 게스트 운영 체제와는 완전히 독립된 공간과 시스템 자원을 할당받아 사용한다. 이러한 가상화 방식을 사용하는 툴 VirtualBox, VMware 등이 있다. 
- 가상머신은 하이퍼 바이저를 통해 여러개의 운영 체제를 생성하고 관리한다. 시스템 자원을 가상화하고 독립된 공간을 생성하는 작업은 하이퍼바이저를 거치므로 성능 손실이크다. 가상머신은 Guest OS를 사용하기 위한 라이브러리, 커널 등을 포함하므로 배포할 때 용량이 크다.
    - 하이퍼바이저 : 하이퍼바이저(Hypervisor)는 하나의 물리적인 컴퓨터(호스트) 위에서 여러 개의 가상 머신(VM)을 만들고 운영할 수 있도록 가상화를 관리해주는 소프트웨어 또는 시스템으로 가상 머신을 만들고, 각각의 가상 머신이 독립적으로 운영체제를 실행할 수 있게 해주는 관리자다.
- 반면 도커 컨테이너는 가상화 된 공간을 생성 할때 리눅스 자체 기능을 사용하여 프로세스 단위로 격리환경을 만드므로 성능 손실이 없다. 가상머신과 달리 커널을 공유해서 사용하므로 컨테이너에는 라이브러리 및 실행 파일만 있으므로 용량이 작다. 그렇기때문에 컨테이너를 이미지로 만들었을때 배포하는 시간이 가상 머신에 비해 빠르며 사용할 때의 성능 손실 또한 거의 없다.
    - 커널 : 운영체제(OS)의 핵심 부분으로, 하드웨어와 소프트웨어 사이를 중재하는 역할을 한다. 하드웨어 제어하거나 메모리 관리, 파일 시스템관리 등의 일을 한다.
    - 가상 머신은 하드웨어를 가상화하고 그 위에 별도의 OS(커널 포함) 를 설치해서 사용하지만 도커 컨테이너는 호스트 OS의 커널을 그대로 사용한다. 즉, 도커 컨테이너는 별도의 커널을 가지지 않고, 호스트 리눅스의 커널을 함께 사용합니다. 그래서 빠르고 가볍고, 성능 손실이 적다.

### 질문
#### Docker 컨테이너와 가상 머신(VM)의 가장 큰 차이점은 무엇인가요?
- 가상 머신(VM)은 하이퍼바이저를 통해 전체 운영체제(OS)와 커널까지 가상화하기 때문에 무겁고 부팅 시간이 길며, 메모리 사용량이 많습니다.
반면 Docker 컨테이너는 호스트 OS의 커널을 공유하면서 애플리케이션과 그 의존성만을 패키징해 실행하는 경량 가상화 기술입니다. 즉, 컨테이너는 별도의 커널이 필요 없고, 프로세스 단위로 실행되기 때문에 VM보다 훨씬 빠르고 가볍습니다.

#### Docker가 배포 환경에서 유용한 이유는 무엇인가요?
- Docker는 이미지 기반 배포 방식을 통해 일관된 실행 환경을 제공하므로 "개발 환경에서는 되는데 운영 환경에서는 안 되는" 문제를 방지할 수 있습니다.
또한, 이미지가 레이어로 구성되어 있어 변경된 부분만 반영하여 빠르게 배포할 수 있으며, 컨테이너는 몇 초 만에 실행 가능하므로 배포 속도가 매우 빠릅니다.
이를 통해 수백, 수천 대의 서버에 동일한 환경을 손쉽게 배포할 수 있어 대규모 서비스에 특히 유리합니다.


---

참고링크 

https://velog.io/@gyumin_2/Docker%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80%EA%B0%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4

https://hstory0208.tistory.com/entry/Docker%EB%8F%84%EC%BB%A4%EC%97%90-%EB%8C%80%ED%95%B4-%EC%95%8C%EC%95%84%EB%B3%B4%EC%9E%90

https://velog.io/@gyumin_2/Docker%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80%EA%B0%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4


https://velog.io/@markany/%EB%8F%84%EC%BB%A4%EC%97%90-%EB%8C%80%ED%95%9C-%EC%96%B4%EB%96%A4-%EA%B2%83-1.-%EB%8F%84%EC%BB%A4%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80